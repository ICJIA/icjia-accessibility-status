"use strict";(self.webpackChunkicjia_accessibility_docs=self.webpackChunkicjia_accessibility_docs||[]).push([[4347],{3023:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(3696);const r={},c=i.createContext(r);function o(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(c.Provider,{value:n},e.children)}},8044:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"setup/monorepo-setup","title":"Monorepo Setup","description":"Guide to setting up the monorepo structure","source":"@site/docs/setup/monorepo-setup.md","sourceDirName":"setup","slug":"/setup/monorepo-setup","permalink":"/docs/docs/setup/monorepo-setup","draft":false,"unlisted":false,"editUrl":"https://github.com/ICJIA/icjia-accessibility-status/tree/main/docs/docs/setup/monorepo-setup.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Monorepo Setup","sidebar_position":1,"description":"Guide to setting up the monorepo structure"},"sidebar":"tutorialSidebar","previous":{"title":"API Keys","permalink":"/docs/docs/api/api-keys"},"next":{"title":"Deployment Overview","permalink":"/docs/docs/deployment/overview"}}');var r=s(2540),c=s(3023);const o={title:"Monorepo Setup",sidebar_position:1,description:"Guide to setting up the monorepo structure"},l="Yarn Workspaces Monorepo Setup",d={},a=[{value:"Overview",id:"overview",level:2},{value:"What Changed",id:"what-changed",level:2},{value:"\u2705 Single Installation Command",id:"-single-installation-command",level:3},{value:"\u2705 Single yarn.lock File",id:"-single-yarnlock-file",level:3},{value:"\u2705 Workspace Structure",id:"-workspace-structure",level:3},{value:"Workspaces",id:"workspaces",level:2},{value:"Root Workspace: <code>icjia-accessibility-status</code>",id:"root-workspace-icjia-accessibility-status",level:3},{value:"Docs Workspace: <code>icjia-accessibility-docs</code>",id:"docs-workspace-icjia-accessibility-docs",level:3},{value:"Updated Commands",id:"updated-commands",level:2},{value:"How Yarn Workspaces Work",id:"how-yarn-workspaces-work",level:2},{value:"Dependency Hoisting",id:"dependency-hoisting",level:3},{value:"Workspace Commands",id:"workspace-commands",level:3},{value:"Benefits",id:"benefits",level:2},{value:"Migration Notes",id:"migration-notes",level:2},{value:"What Stayed the Same",id:"what-stayed-the-same",level:3},{value:"What Changed",id:"what-changed-1",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"&quot;Cannot find module&quot; errors",id:"cannot-find-module-errors",level:3},{value:"Workspace not recognized",id:"workspace-not-recognized",level:3},{value:"Docs not starting",id:"docs-not-starting",level:3},{value:"Future Improvements",id:"future-improvements",level:2},{value:"References",id:"references",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"yarn-workspaces-monorepo-setup",children:"Yarn Workspaces Monorepo Setup"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ICJIA Accessibility Status Portal has been converted to a ",(0,r.jsx)(n.strong,{children:"Yarn Workspaces monorepo"})," structure. This simplifies dependency management and installation across all services (frontend, backend, and documentation)."]}),"\n",(0,r.jsx)(n.h2,{id:"what-changed",children:"What Changed"}),"\n",(0,r.jsx)(n.h3,{id:"-single-installation-command",children:"\u2705 Single Installation Command"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Before:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"yarn install          # Install root dependencies\ncd docs && yarn install  # Install docs dependencies separately\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"After:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"yarn install          # Installs ALL dependencies (frontend, backend, docs)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"-single-yarnlock-file",children:"\u2705 Single yarn.lock File"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Before:"})," Two separate ",(0,r.jsx)(n.code,{children:"yarn.lock"})," files","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/yarn.lock"})," (root)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/docs/yarn.lock"})," (docs)"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"After:"})," One ",(0,r.jsx)(n.code,{children:"yarn.lock"})," file at root","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All dependencies managed in a single lock file"}),"\n",(0,r.jsx)(n.li,{children:"Consistent versions across all services"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"-workspace-structure",children:"\u2705 Workspace Structure"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"icjia-accessibility-status/\n\u251c\u2500\u2500 package.json (root workspace)\n\u251c\u2500\u2500 yarn.lock (single lock file)\n\u251c\u2500\u2500 src/ (frontend code)\n\u251c\u2500\u2500 server/ (backend code)\n\u251c\u2500\u2500 docs/\n\u2502   \u251c\u2500\u2500 package.json (docs workspace)\n\u2502   \u251c\u2500\u2500 docs/ (markdown files)\n\u2502   \u2514\u2500\u2500 src/ (Docusaurus components)\n\u2514\u2500\u2500 ...\n"})}),"\n",(0,r.jsx)(n.h2,{id:"workspaces",children:"Workspaces"}),"\n",(0,r.jsxs)(n.h3,{id:"root-workspace-icjia-accessibility-status",children:["Root Workspace: ",(0,r.jsx)(n.code,{children:"icjia-accessibility-status"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Location:"})," ",(0,r.jsx)(n.code,{children:"/"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Services:"})," Frontend (React/Vite) + Backend (Express)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependencies:"})," React, Express, Tailwind, Recharts, etc."]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"docs-workspace-icjia-accessibility-docs",children:["Docs Workspace: ",(0,r.jsx)(n.code,{children:"icjia-accessibility-docs"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Location:"})," ",(0,r.jsx)(n.code,{children:"/docs"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Services:"})," Documentation site (Docusaurus)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Dependencies:"})," Docusaurus, React, TypeScript"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"updated-commands",children:"Updated Commands"}),"\n",(0,r.jsx)(n.p,{children:"All commands work from the root directory:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Development\nyarn dev              # Start all three services\nyarn dev:frontend     # Frontend only\nyarn dev:backend      # Backend only\nyarn dev:docs         # Docs only\nyarn dev:all          # Alias for yarn dev\n\n# Building\nyarn build            # Build all services\nyarn build:frontend   # Frontend only\nyarn build:docs       # Docs only\n\n# Other commands\nyarn seed             # Populate database\nyarn lint             # Run ESLint\nyarn typecheck        # TypeScript checking\nyarn reset:users      # Reset admin users\nyarn reset:app        # Complete database reset\n"})}),"\n",(0,r.jsx)(n.h2,{id:"how-yarn-workspaces-work",children:"How Yarn Workspaces Work"}),"\n",(0,r.jsx)(n.h3,{id:"dependency-hoisting",children:"Dependency Hoisting"}),"\n",(0,r.jsxs)(n.p,{children:["Yarn automatically hoists common dependencies to the root ",(0,r.jsx)(n.code,{children:"node_modules/"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"react"})," (used by both frontend and docs)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"typescript"})," (used by both)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"@types/*"})," packages"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Workspace-specific dependencies stay in their workspace:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/node_modules/"})," (root) - shared dependencies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"/docs/node_modules/"})," (docs) - docs-specific dependencies"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"workspace-commands",children:"Workspace Commands"}),"\n",(0,r.jsx)(n.p,{children:"Run commands in a specific workspace:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Run a script in the docs workspace\nyarn workspace icjia-accessibility-docs start\n\n# Run a script in the root workspace\nyarn workspace icjia-accessibility-status build:frontend\n"})}),"\n",(0,r.jsx)(n.h2,{id:"benefits",children:"Benefits"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Simplified Installation"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Single ",(0,r.jsx)(n.code,{children:"yarn install"})," installs everything"]}),"\n",(0,r.jsx)(n.li,{children:"No need to navigate to subdirectories"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Consistent Versions"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Single ",(0,r.jsx)(n.code,{children:"yarn.lock"})," file"]}),"\n",(0,r.jsx)(n.li,{children:"All services use the same dependency versions"}),"\n",(0,r.jsx)(n.li,{children:"Eliminates version conflicts"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Easier Maintenance"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Centralized dependency management"}),"\n",(0,r.jsx)(n.li,{children:"Easier to update packages across all services"}),"\n",(0,r.jsx)(n.li,{children:"Better visibility into the entire dependency tree"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Improved Developer Experience"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Faster installation (dependencies downloaded once)"}),"\n",(0,r.jsx)(n.li,{children:"Clearer project structure"}),"\n",(0,r.jsx)(n.li,{children:"Standard monorepo pattern"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"migration-notes",children:"Migration Notes"}),"\n",(0,r.jsx)(n.h3,{id:"what-stayed-the-same",children:"What Stayed the Same"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All existing scripts work exactly as before"}),"\n",(0,r.jsx)(n.li,{children:"All services run on the same ports"}),"\n",(0,r.jsx)(n.li,{children:"No changes to deployment process"}),"\n",(0,r.jsx)(n.li,{children:"No changes to environment variables"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"what-changed-1",children:"What Changed"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docs/yarn.lock"})," was removed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"package.json"})," files updated with workspace configuration"]}),"\n",(0,r.jsxs)(n.li,{children:["Scripts now use ",(0,r.jsx)(n.code,{children:"yarn workspace"})," commands internally"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"cannot-find-module-errors",children:'"Cannot find module" errors'}),"\n",(0,r.jsx)(n.p,{children:"If you get module not found errors after the migration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Clear node_modules and reinstall\nrm -rf node_modules docs/node_modules\nyarn install\n"})}),"\n",(0,r.jsx)(n.h3,{id:"workspace-not-recognized",children:"Workspace not recognized"}),"\n",(0,r.jsx)(n.p,{children:"Verify the workspace setup:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"yarn workspaces info\n"})}),"\n",(0,r.jsx)(n.p,{children:"Should output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "icjia-accessibility-status": { "location": "" },\n  "icjia-accessibility-docs": { "location": "docs" }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"docs-not-starting",children:"Docs not starting"}),"\n",(0,r.jsxs)(n.p,{children:["If ",(0,r.jsx)(n.code,{children:"yarn dev:docs"})," fails:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Try running directly\nyarn workspace icjia-accessibility-docs start\n\n# Or check for port conflicts\nlsof -i :3002\n"})}),"\n",(0,r.jsx)(n.h2,{id:"future-improvements",children:"Future Improvements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Consider adding shared utilities workspace"}),"\n",(0,r.jsx)(n.li,{children:"Implement monorepo-wide linting"}),"\n",(0,r.jsx)(n.li,{children:"Add shared TypeScript configuration"}),"\n",(0,r.jsx)(n.li,{children:"Consider Yarn 3+ for better performance"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://classic.yarnpkg.com/en/docs/workspaces/",children:"Yarn Workspaces Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://monorepo.tools/",children:"Monorepo Best Practices"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}}}]);